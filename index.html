<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Facsimil Autoevaluación — Juntas de Vecinos</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- TOPBAR -->
  <header class="topbar">
    <div class="wrap topwrap">
      <div class="brand-left">
        <div class="brand-title">Facsimil Autoevaluación</div>
      </div>
      <div class="rightblock">
        <div class="right-row">
          <button class="bell" title="Notificaciones" aria-label="Notificaciones">
            <svg viewBox="0 0 24 24" class="icon" aria-hidden="true">
              <path d="M15 17h5l-1.4-1.4A2 2 0 0 1 18 14.2V11a6 6 0 0 0-12 0v3.2c0 .5-.2 1-.6 1.4L4 17h5m6 0a3 3 0 0 1-6 0"
                    fill="none" stroke="currentColor" stroke-width="2"/>
            </svg>
          </button>

          <!-- Toggle Tema -->
          <button id="themeToggle" class="btn tiny outline theme-toggle" type="button" title="Cambiar tema">
            <svg class="icon sun" viewBox="0 0 24 24" aria-hidden="true">
              <circle cx="12" cy="12" r="5" fill="none" stroke="currentColor" stroke-width="2"/>
              <path d="M12 1v3M12 20v3M4.2 4.2l2.1 2.1M17.7 17.7l2.1 2.1M1 12h3M20 12h3M4.2 19.8l2.1-2.1M17.7 6.3l2.1-2.1"
                    fill="none" stroke="currentColor" stroke-width="2"/>
            </svg>
            <svg class="icon moon" viewBox="0 0 24 24" aria-hidden="true">
              <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"
                    fill="none" stroke="currentColor" stroke-width="2"/>
            </svg>
            <span>Tema</span>
          </button>

          <!-- Chip USER -->
          <div class="userchip" aria-label="Usuario">
            <span class="user-dot"></span>
            <span class="user-label" id="topUserLabel">USER</span>
            <svg class="caret" viewBox="0 0 24 24" aria-hidden="true">
              <path d="M6 9l6 6 6-6" fill="none" stroke="currentColor" stroke-width="2"/>
            </svg>
          </div>

          <button id="logoutBtn" class="btn tiny outline" style="display:none" type="button">Cerrar sesión</button>
        </div>
        <div class="orgname" id="topOrgName">Organización Comunitaria</div>
      </div>
    </div>
  </header>

  <!-- LAYOUT -->
  <div class="layout">
    <!-- SIDEBAR -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <div class="welcome">Bienvenido</div>
        <label class="avatar-uploader" title="Subir foto de usuario">
          <input type="file" id="avatarInput" accept="image/*" hidden />
          <div class="avatar-lg" id="avatarPreview" aria-label="Avatar de usuario"></div>
        </label>
      </div>

      <h3>Home</h3>
      <nav class="nav">
        <a href="#" class="active">Principal</a>
        <a href="#">Home</a>
      </nav>

      <h3>Usuarios</h3>
      <nav class="nav">
        <a href="#">Usuarios</a>
        <a href="#">Facsimil</a>
        <a href="#">Listado</a>
      </nav>
    </aside>

    <!-- ===== AUTH ===== -->
    <section id="authGate" class="auth-gate" aria-live="polite">
      <div class="auth-card">
        <h2>Organizaciones Comunitarias</h2>
        <p class="muted">Inscribe tu organización o accede si ya fue aprobada.</p>

        <div class="auth-grid">
          <!-- Registro -->
          <div class="auth-panel">
            <h3>Inscribir organización</h3>
            <form id="orgRegisterForm">
              <label for="razon">Razón social</label>
              <input id="razon" type="text" name="razon" required>
              <label for="rut">RUT organización</label>
              <input id="rut" type="text" name="rut" required>
              <label for="dom_org">Domicilio organización</label>
              <input id="dom_org" type="text" name="dom_org" required>

              <hr class="sep">
              <label for="rep_run">Representante legal — RUN</label>
              <input id="rep_run" type="text" name="rep_run" required>
              <label for="rep_nombre">Representante — Nombre</label>
              <input id="rep_nombre" type="text" name="rep_nombre" required>
              <label for="rep_dom">Representante — Domicilio</label>
              <input id="rep_dom" type="text" name="rep_dom" required>

              <hr class="sep">
              <label for="email">Usuario (owner) — Email</label>
              <input id="email" type="email" name="email" required>
              <label for="pass">Contraseña</label>
              <input id="pass" type="password" name="pass" required>

              <button type="submit" class="btn primary wfull">Inscribir (pendiente)</button>
            </form>
            <div class="help">Un administrador deberá aprobarla para poder acceder al formulario.</div>
          </div>

          <!-- Login -->
          <div class="auth-panel">
            <h3>Ingresar</h3>
            <form id="loginForm">
              <label for="login_email">Email</label>
              <input id="login_email" type="email" name="email" required>
              <label for="login_pass">Contraseña</label>
              <input id="login_pass" type="password" name="pass" required>
              <button type="submit" class="btn primary wfull">Entrar</button>
            </form>
            <div class="help">Solo organizaciones <b>aprobadas</b> pueden acceder.</div>
          </div>

          <!-- Admin demo -->
          <div class="auth-panel">
            <h3>Admin (DEMO)</h3>
            <form id="adminForm">
              <label for="adminkey">Clave admin demo</label>
              <input id="adminkey" type="password" name="adminkey" placeholder="admin123" required>
              <button type="submit" class="btn ghost wfull">Entrar</button>
            </form>
            <div id="adminPanel" class="admin-panel hidden">
              <div class="admin-head">
                <strong>Pendientes</strong>
                <button id="adminLogout" class="btn tiny" type="button">Salir</button>
              </div>
              <div id="pendingList" class="pending-list muted">Sin pendientes…</div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ===== MAIN APP ===== -->
    <main class="card" id="appMain" style="display:none">
      <div class="tabs" id="tabs"></div>
      <div id="validationMessages" class="validation"></div>
      <div id="content-area" class="panel"></div>
    </main>

<!-- ===== Dock flotante ===== -->
<div class="score-dock" id="scoreDock" aria-live="polite">
  <button id="dockToggle" class="dock-toggle" type="button" aria-label="Colapsar/expandir"></button>

  <div class="sd-title">Puntaje</div>

  <div class="sd-score">
    <span id="sdScore">0</span> / <span id="sdMax">0</span>
    <span id="sdPct" class="sd-pct">0% completado</span>
  </div>

  <div class="sd-level" id="sdLevel">-</div>

  <div class="sd-bar"><span id="sdBar"></span></div>

  <div class="sd-actions">
    <button id="cancelBtnDock" class="btn ghost tiny" type="button" title="Cancelar">
      <svg viewBox="0 0 24 24" class="icon" aria-hidden="true">
        <path d="M6 6l12 12M18 6L6 18" fill="none" stroke="currentColor" stroke-width="2"/>
      </svg>
      Cancelar
    </button>

    <div class="savewrap">
      <button id="saveBtnDock" class="btn primary tiny" type="button" title="Guardar">
        <svg viewBox="0 0 24 24" class="icon" aria-hidden="true">
          <path d="M19 21H5a2 2 0 0 1-2-2V7l4-4h12a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2zM7 3v6h8V3" fill="none" stroke="currentColor" stroke-width="2"/>
        </svg>
        Guardar
      </button>

      <div id="saveMenuDock" class="save-menu" aria-hidden="true">
        <button id="saveJsonDock" class="menu-item" type="button">Guardar JSON</button>
        <button id="exportCsvDock" class="menu-item" type="button">Exportar CSV</button>
      </div>
    </div>
  </div>
</div>

  <script src="script.js"></script>
</body>
</html>
