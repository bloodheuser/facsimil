<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Facsimil Autoevaluación — Juntas de Vecinos</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- TOPBAR -->
  <header class="topbar">
    <div class="wrap topwrap">
      <div class="brand-left">
        <div class="brand-title">Facsimil</div>
      </div>
      <div class="rightblock">
        <div class="right-row">
          <!-- Campanita -->
          <button class="bell" title="Notificaciones">
            <svg viewBox="0 0 24 24" class="icon" aria-hidden="true">
              <path d="M15 17h5l-1.4-1.4A2 2 0 0 1 18 14.2V11a6 6 0 0 0-12 0v3.2c0 .5-.2 1-.6 1.4L4 17h5m6 0a3 3 0 0 1-6 0"
                    fill="none" stroke="currentColor" stroke-width="2"/>
            </svg>
          </button>

          <!-- Chip USER -->
          <div class="userchip">
            <span class="user-dot"></span>
            <span class="user-label" id="topUserLabel">USER</span>
            <svg class="caret" viewBox="0 0 24 24" aria-hidden="true">
              <path d="M6 9l6 6 6-6" fill="none" stroke="currentColor" stroke-width="2"/>
            </svg>
          </div>

          <!-- Cerrar sesión -->
          <button id="logoutBtn" class="btn tiny outline" style="display:none">Cerrar sesión</button>
        </div>

        <!-- Nombre organización -->
        <div class="orgname" id="topOrgName">Organización Comunitaria</div>
      </div>
    </div>
  </header>

  <!-- LAYOUT -->
  <div class="layout">
    <!-- SIDEBAR -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <div class="welcome">Bienvenido</div>
        <!-- Avatar/Uploader futuro -->
        <label class="avatar-uploader" title="Subir foto de usuario">
          <input type="file" id="avatarInput" accept="image/*" hidden />
          <div class="avatar-lg" id="avatarPreview" aria-label="Avatar de usuario"></div>
        </label>
      </div>

      <!-- HOME -->
      <h3>Home</h3>
      <nav class="nav">
        <a href="#" class="active">Principal</a>
        <a href="#">Home</a>
      </nav>

      <!-- USUARIOS -->
      <h3>Usuarios</h3>
      <nav class="nav">
        <a href="#">Usuarios</a>
        <a href="#">Facsimil</a>
        <a href="#">Listado</a>
      </nav>
    </aside>

    <!-- ===== AUTH GATE (DEMO sin backend) ===== -->
    <section id="authGate" class="auth-gate" aria-live="polite">
      <div class="auth-card">
        <h2>Organizaciones Comunitarias</h2>
        <p class="muted">Inscribe tu organización o accede si ya fue aprobada.</p>

        <div class="auth-grid">
          <!-- Inscribir organización -->
          <div class="auth-panel">
            <h3>Inscribir organización</h3>
            <form id="orgRegisterForm">
              <label for="razon">Razón social</label>
              <input id="razon" type="text" name="razon" required>
              <label for="rut">RUT organización</label>
              <input id="rut" type="text" name="rut" required>
              <label for="dom_org">Domicilio organización</label>
              <input id="dom_org" type="text" name="dom_org" required>

              <hr class="sep">

              <label for="rep_run">Representante legal — RUN</label>
              <input id="rep_run" type="text" name="rep_run" required>
              <label for="rep_nombre">Representante — Nombre</label>
              <input id="rep_nombre" type="text" name="rep_nombre" required>
              <label for="rep_dom">Representante — Domicilio</label>
              <input id="rep_dom" type="text" name="rep_dom" required>

              <hr class="sep">

              <label for="email">Usuario (owner) — Email</label>
              <input id="email" type="email" name="email" required>
              <label for="pass">Contraseña</label>
              <input id="pass" type="password" name="pass" required>

              <button type="submit" class="btn primary wfull">Inscribir (pendiente)</button>
            </form>
            <div class="help">Un administrador deberá aprobarla para poder acceder al formulario.</div>
          </div>

          <!-- Ingresar -->
          <div class="auth-panel">
            <h3>Ingresar</h3>
            <form id="loginForm">
              <label for="login_email">Email</label>
              <input id="login_email" type="email" name="email" required>
              <label for="login_pass">Contraseña</label>
              <input id="login_pass" type="password" name="pass" required>
              <button type="submit" class="btn primary wfull">Entrar</button>
            </form>
            <div class="help">Solo organizaciones <b>aprobadas</b> pueden acceder.</div>
          </div>

          <!-- Admin (DEMO) -->
          <div class="auth-panel">
            <h3>Admin (DEMO)</h3>
            <form id="adminForm">
              <label for="adminkey">Clave admin demo</label>
              <input id="adminkey" type="password" name="adminkey" placeholder="admin123" required>
              <button type="submit" class="btn ghost wfull">Entrar</button>
            </form>

            <div id="adminPanel" class="admin-panel hidden">
              <div class="admin-head">
                <strong>Pendientes</strong>
                <button id="adminLogout" class="btn tiny">Salir</button>
              </div>
              <div id="pendingList" class="pending-list muted">Sin pendientes…</div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <!-- ===== /AUTH GATE ===== -->

    <!-- ===== MAIN APP ===== -->
    <main class="card" id="appMain" style="display:none">
      <!-- Tabs dinámicos -->
      <div class="tabs" id="tabs"></div>

      <!-- Mensajes de validación -->
      <div id="validationMessages" class="validation"></div>

      <!-- Contenido dinámico -->
      <div id="content-area" class="panel"></div>

      <!-- Controles originales (ocultos en CSS; los dejamos por fallback) -->
      <div class="controls">
        <div class="btns">
          <button id="cancelBtn" class="btn ghost" type="button">Cancelar</button>
          <button id="saveBtn" class="btn primary" type="button">Guardar</button>
          <!-- Menú contextual original -->
          <div id="saveMenu" class="save-menu" aria-hidden="true">
            <button id="saveJson" class="menu-item" type="button">Guardar JSON</button>
            <button id="exportCsv" class="menu-item" type="button">Exportar CSV</button>
          </div>
        </div>
      </div>
    </main>
    <!-- ===== /MAIN APP ===== -->

    <!-- Dock flotante: puntaje + acciones -->
    <div class="score-dock" id="scoreDock" aria-live="polite">
      <div class="sd-title">Puntaje</div>
      <div class="sd-score">
        <span id="sdScore">0</span> / <span id="sdMax">0</span>
      </div>
      <div class="sd-level" id="sdLevel">-</div>
      <div class="sd-bar"><span id="sdBar"></span></div>

      <!-- Acciones en el dock -->
      <div class="sd-actions">
        <button id="cancelBtnDock" class="btn ghost tiny" type="button">
          <!-- ícono cancelar -->
          <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><path d="M6 6l12 12M18 6L6 18" fill="none" stroke="currentColor" stroke-width="2"/></svg>
          Cancelar
        </button>
        <div class="savewrap">
          <button id="saveBtnDock" class="btn primary tiny" type="button">
            <!-- ícono guardar -->
            <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><path d="M19 21H5a2 2 0 0 1-2-2V7l4-4h12a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2zM7 3v6h8V3" fill="none" stroke="currentColor" stroke-width="2"/></svg>
            Guardar
          </button>
          <!-- Menú contextual del dock -->
          <div id="saveMenuDock" class="save-menu" aria-hidden="true">
            <button id="saveJsonDock" class="menu-item" type="button">Guardar JSON</button>
            <button id="exportCsvDock" class="menu-item" type="button">Exportar CSV</button>
          </div>
        </div>
      </div>
    </div>
  </div> <!-- /layout -->

  <script src="script.js"></script>
</body>
</html>
